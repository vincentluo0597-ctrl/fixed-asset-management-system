# 系统介绍（Java_gdzc）

## 一、系统概述
固资设备管理与调用系统，主要面向企业设备资产在内部流转、使用与借还过程的规范化管理。当前版本已实现调用创建、完成/取消、分页与筛选、逾期提示、统计看板与基础后台页面。

## 二、核心业务流程
1) 创建调用
- 选择设备、调用类型（调拨/借出/归还/移动）、相关位置与人员、调用说明
- 借出（LOAN）类型可填写预期归还日期
2) 进行中（ACTIVE）
- 新创建的调用默认为进行中状态
3) 完成或取消
- 完成：设备状态与位置同步更新（按业务规则），调用状态变更为 COMPLETED
- 取消：仅对进行中的调用允许取消，状态变更为 CANCELLED
4) 逾期高亮
- 借出（LOAN）且进行中，超过预期归还日期的记录在列表中高亮提示

## 三、数据模型（简要）
- Equipment：设备基本信息（名称、资产编号等）
- EquipmentTransfer：设备调用记录（类型、状态、关联位置与人员、说明、时间、预期归还日期等）
- Location：位置（科室/仓库/机房等）
- User：用户（系统登录用户，含角色）
- 其他：分类、供应商等（如项目中存在相关模块）

## 四、系统界面
- 后台页面：/admin/transfers
  - 顶部统计：总调用、进行中、逾期数量
  - 工具栏：新建调用、查看逾期、刷新统计；类型与状态筛选、“只看我的”开关
  - 列表：分页展示，逾期记录高亮；进行中记录支持完成/取消操作
  - 创建模态框：设备、类型、位置、人员、说明与（可选）预期归还日期字段
- 页面左上角 Logo：通过 src/main/resources/static/logo.jpg 加载，在侧边栏顶部显示

## 五、接口与集成
- 分页与筛选
  - GET /api/equipment-transfers/page?page=0&size=10
  - 可选参数：type、status
- 我的调用（分页）
  - GET /api/equipment-transfers/my-transfers?page=0&size=10
- 创建调用
  - POST /api/equipment-transfers
- 完成/取消
  - PUT /api/equipment-transfers/{id}/complete
  - PUT /api/equipment-transfers/{id}/cancel
- 逾期借出列表（不分页）：
  - GET /api/equipment-transfers/overdue
- API 文档（springdoc）：/swagger-ui/index.html
- 操作日志（新增）：
  - 分页与筛选：GET /api/operation-logs/page?actor=&entityType=&entityId=&action=&from=&to=&keyword=&page=0&size=20&sort=createdAt,desc
  - 最新记录：GET /api/operation-logs/latest?entityType=Equipment&entityId=1[&action=UPDATE]
  - 导出 CSV：GET /api/operation-logs/export（返回列：id,createdAt,actor,entityType,entityId,action,details）
  - 后台管理页面：/admin/operation-logs（提供筛选、分页、导出按钮）

## 六、部署与环境
- 运行环境：Java 17、Maven 3.9+、MySQL 8.x（或开发用 H2）
- 端口：示例以 13700 为主，可通过 --server.port 指定
- 数据库迁移：通过 Flyway 管理 SQL 变更
- 中文编码：统一 utf8mb4；连接串含 useUnicode=true、characterEncoding=utf8/utf8mb4；页面模板使用 UTF-8

## 七、运维建议
- 备份与恢复：定期数据库备份（全量/增量），迁移前先验证
- 监控与告警：接入日志采集与监控平台，关注错误率、响应时间、慢查询
- 变更管理：通过 Flyway 脚本变更；上线前演练与回滚方案
- 安全：权限最小化、强密码策略、HTTPS、必要的审计日志

## 八、后续升级方向
- UI/体验：暗色模式、移动端适配、仪表盘与图表、批量操作、友好空态与 Loading 效果
- 业务功能：审批流、附件管理（图片/文档）、消息通知（邮件/企业微信）、导入导出（Excel/CSV）、高级搜索
- 权限与集成：更细粒度的 RBAC、SSO/OIDC、第三方平台对接
- 性能与可靠性：缓存（Redis）、索引与查询优化、压测与容量评估、幂等与重试
- DevOps：Docker 化、CI/CD 流水线、自动化测试、质量门禁与代码规范

## 九、注意事项
- 登录与权限：请在数据层或初始化脚本中设置用户与角色，以保障后台页面访问与操作权限
- 数据一致性：完成调用时需同步设备状态与位置，具体逻辑应与企业实际流程对齐
- 版本管理：建议为重要接口/页面变更制定版本与变更日志